model NodeDrift {
  id     String @id @default(cuid())
  userId String
  nodeId String

  // Spatial data
  originalLatitude  Float // Node's pre-drift location 
  originalLongitude Float
  newLatitude       Float // Node's post-drift location
  newLongitude      Float

  // Economics
  sharePointsCost Float // Cost paid (in sharePoints)
  nodeRarity      NodeTypeRarity

  // Metadata
  driftRadius      Float @default(10.0) // km radius for spawn
  originalDistance Float // km from user to original node

  timestamp DateTime @default(now())

  // V2.0 additions: Grace period and personal lock
  gracePeriodEndsAt  DateTime? // When node becomes available to others (timestamp + 7 days)
  personalLockEndsAt DateTime? // When original drifter loses priority (timestamp + 72 hours)

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  node Node @relation(fields: [nodeId], references: [id], onDelete: Cascade)

  @@index([userId, timestamp])
  @@index([nodeId])
  @@index([gracePeriodEndsAt])
  @@index([personalLockEndsAt])
  @@index([nodeId, gracePeriodEndsAt])
  @@map("node_drifts")
}
